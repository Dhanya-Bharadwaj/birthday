<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Make a Wish — Video</title>
    <style>
      :root{
        --accent: #ff69b4;
        --bg1: #fff0f6;
        --bg2: #fdeef6;
        --glass: rgba(255,255,255,0.08);
      }
      html,body{height:100%;}
      body{
        margin:0;
        font-family: 'Poppins', sans-serif;
        background: linear-gradient(120deg,var(--bg1), var(--bg2));
        display:flex;
        align-items:center;
        justify-content:center;
        overflow:hidden;
      }

      /* animated gradient background */
      .bg-anim {
        position:fixed; inset:0; z-index:0; pointer-events:none;
        background: radial-gradient(circle at 10% 20%, rgba(255,240,250,0.6), transparent 8%),
                    radial-gradient(circle at 80% 80%, rgba(240,250,255,0.6), transparent 12%);
        animation: bg-move 12s linear infinite;
        filter: blur(6px) saturate(1.1);
      }
      @keyframes bg-move{ 0%{transform:translateY(0)} 50%{transform:translateY(-30px)} 100%{transform:translateY(0)} }

      /* floating stars */
      .stars { position:fixed; inset:0; z-index:1; pointer-events:none;}
      .star{ position:absolute; width:8px; height:8px; background:var(--accent); border-radius:50%; box-shadow:0 0 8px rgba(255,105,180,0.8); opacity:0.9; }
      .star.s1{ left:8%; top:20%; animation: float1 6s ease-in-out infinite; }
      .star.s2{ left:20%; top:12%; animation: float2 8s ease-in-out infinite; width:6px; height:6px; }
      .star.s3{ left:70%; top:18%; animation: float1 7s ease-in-out infinite; }
      .star.s4{ left:85%; top:28%; animation: float3 9s ease-in-out infinite; width:5px; height:5px; }
      @keyframes float1{0%{transform:translateY(0) scale(1)}50%{transform:translateY(-18px) scale(1.2)}100%{transform:translateY(0) scale(1)}}
      @keyframes float2{0%{transform:translateY(0) scale(1)}50%{transform:translateY(-28px) scale(1.3)}100%{transform:translateY(0) scale(1)}}
      @keyframes float3{0%{transform:translateY(0) scale(1)}50%{transform:translateY(-10px) scale(0.9)}100%{transform:translateY(0) scale(1)}}

      .page{ position:relative; z-index:5; width:95%; max-width:980px; padding:28px; display:flex; flex-direction:column; align-items:center; gap:14px}

      h1.title{ font-family:'Dancing Script', cursive; font-size:2.4rem; margin:0; color:var(--accent); text-shadow:0 6px 18px rgba(255,105,180,0.12) }
      .caption{ color:#444; text-align:center; max-width:760px }

      .video-wrap{ width:100%; border-radius:14px; overflow:hidden; background:linear-gradient(180deg,rgba(0,0,0,0.9), rgba(0,0,0,0.75)); box-shadow:0 18px 60px rgba(0,0,0,0.35); transform:translateY(30px) scale(0.96); opacity:0; animation: popIn 700ms cubic-bezier(.2,.9,.2,1) forwards; }
      @keyframes popIn{ to{ transform:none; opacity:1 } }

      video{ width:100%; height:auto; display:block; background:#000 }

      .controls{ display:flex; gap:10px; align-items:center; justify-content:center; margin-top:8px }
      .btn{ padding:10px 14px; border-radius:10px; border:none; cursor:pointer; font-weight:600 }
      .btn.primary{ background:var(--accent); color:white; box-shadow:0 8px 24px rgba(255,105,180,0.18); animation: pulse 2s infinite; }
      .btn.secondary{ background:rgba(255,255,255,0.9); color:#333 }
      @keyframes pulse{0%{transform:scale(1)}50%{transform:scale(1.03)}100%{transform:scale(1)}}

      /* confetti container */
      .confetti-layer{ position:fixed; inset:0; z-index:10; pointer-events:none; overflow:hidden }

      /* small footer note */
      .note{ color:#666; font-size:0.95rem }

      @media (max-width:600px){ .page{ padding:16px } h1.title{ font-size:2rem } }
    </style>
  </head>
  <body>
    <div class="bg-anim" aria-hidden="true"></div>
    <div class="stars" aria-hidden="true">
      <div class="star s1"></div>
      <div class="star s2"></div>
      <div class="star s3"></div>
      <div class="star s4"></div>
    </div>

    <div class="page" role="main">
      <h1 class="title">Your Wish Video</h1>
      <p class="caption">If you uploaded a video named <code>wish_video.mp4</code> into the project folder, it will play below. Otherwise update the source or upload the file. Click <em>Play / Unmute</em> to hear the audio — autoplay with sound may be blocked in some browsers.</p>

      <div class="video-wrap" id="videoWrap">
        <video id="wishPageVideo" playsinline webkit-playsinline preload="metadata" controls>
          <source src="wish_video.mp4" type="video/mp4">
          Your browser does not support the video tag.
        </video>
      </div>

      <div class="controls">
        <button id="backBtn" class="btn secondary">◀ Back to Main</button>
        <button id="playUnmute" class="btn primary">Play / Unmute</button>
      </div>

      <div class="note">Tip: Press Esc to return to the main page. The page will trigger a small confetti burst when the video ends.</div>
    </div>

    <div class="confetti-layer" id="confettiLayer" aria-hidden="true"></div>

    <script>
      (function(){
        const video = document.getElementById('wishPageVideo');
        const back = document.getElementById('backBtn');
        const playUnmute = document.getElementById('playUnmute');
        const confettiLayer = document.getElementById('confettiLayer');
        const params = new URLSearchParams(window.location.search);

        // Try muted autoplay if requested
        if (params.get('autoplay') === '1'){
          video.muted = true;
          const p = video.play();
          if (p && p.catch) p.catch(()=>{/* ignore */});
        }

        back.addEventListener('click', ()=>{ window.location.href = 'bday.html'; });

        playUnmute.addEventListener('click', ()=>{
          try{ video.muted = false; video.play(); }catch(e){}
        });

        // Keyboard: Esc to go back
        document.addEventListener('keydown', (e)=>{
          if (e.key === 'Escape') window.location.href = 'bday.html';
        });

        // Confetti factory (simple)
        function createConfettiBurst(count = 40){
          const colors = ['#ff6b9a','#ffd166','#9ae66b','#7ad3ff','#c79cff'];
          for(let i=0;i<count;i++){
            const el = document.createElement('div');
            el.className = 'confetti';
            const size = Math.random()*10+6;
            el.style.position='absolute';
            el.style.left = (50 + (Math.random()*160-80)) + '%';
            el.style.top = (10 + Math.random()*10) + '%';
            el.style.width = size+'px';
            el.style.height = size*0.6+'px';
            el.style.background = colors[Math.floor(Math.random()*colors.length)];
            el.style.opacity = '0.95';
            el.style.transform = 'rotate('+ (Math.random()*360) +'deg)';
            el.style.borderRadius = '2px';
            el.style.zIndex = 20;
            // animation
            const fallDur = 1500 + Math.random()*1200;
            el.style.transition = `transform ${fallDur}ms cubic-bezier(.2,.8,.3,1), opacity ${fallDur}ms linear`;
            confettiLayer.appendChild(el);
            // trigger after insert
            setTimeout(()=>{
              el.style.transform = `translateY(${window.innerHeight}px) rotate(${Math.random()*720}deg) translateX(${(Math.random()*200-100)}px)`;
              el.style.opacity = '0';
            }, 20 + Math.random()*120);
            // cleanup
            setTimeout(()=>{ try{ confettiLayer.removeChild(el); }catch(e){} }, fallDur + 300);
          }
        }

        // On video end, show confetti and auto-enable a small return after delay
        video.addEventListener('ended', ()=>{
          createConfettiBurst(50);
          // enable visual feedback on back button
          back.classList.add('highlight');
          setTimeout(()=>{ window.location.href = 'bday.html'; }, 4500); // return after 4.5s
        });

        // If video has error, show console message
        video.addEventListener('error', ()=> console.warn('Video failed to load. Ensure wish_video.mp4 is in the project folder.'));

      })();
    </script>
  </body>
</html>
